trivy-operator:
  excludeNamespaces: default
  operator:
    cacheReportTTL: "240h"
    scannerReportTTL: 240h
    scanJobTimeout: 20m
    scanJobsConcurrentLimit: 1
    batchDeleteLimit: 5
    batchDeleteDelay: "30s"
    scanOnlyCurrentRevisions: true
    vulnerabilityScannerScanOnlyCurrentRevisions: true
    configAuditScannerScanOnlyCurrentRevisions: true
    scanJobPodTemplateContainerSecurityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      privileged: false
      readOnlyRootFilesystem: true

  resources:
    requests:
      cpu: 100m
      memory: 512Mi

  serviceMonitor:
    enabled: true
  
  trivy:
    resources:
      requests:
        cpu: 100m
        memory: 2Gi
      limits:
        cpu: 2
        memory: 2Gi

    ignoreUnfixed: true
    cacheDir: "/home/scanner/.cache"
    skipUpdate: true
    quiet: true
    noProgress: true
    
    persistence:
      enabled: true
      size: "5Gi"
      storageClass: "longhorn"
      accessMode: ReadWriteOnce
