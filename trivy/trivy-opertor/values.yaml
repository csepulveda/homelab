trivy-operator:
  excludeNamespaces: default
  operator:
    cacheReportTTL: 240h
    scannerReportTTL: 240h
    scanJobTimeout: 20m
    scanJobsConcurrentLimit: 1
    batchDeleteLimit: 5
    batchDeleteDelay: "30s"
    scanOnlyCurrentRevisions: true
    vulnerabilityScannerScanOnlyCurrentRevisions: true
    configAuditScannerScanOnlyCurrentRevisions: true
    scanJobPodTemplateContainerSecurityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      privileged: false
      readOnlyRootFilesystem: false
    builtInTrivyServer: true

  resources:
    requests:
      cpu: 100m
      memory: 512Mi

  serviceMonitor:
    enabled: true
  
  trivy:
    resources:
      requests:
        cpu: 100m
        memory: 2Gi
      limits:
        cpu: 1
        memory: 3Gi

    ignoreUnfixed: true
    imageScanCacheDir: "/var/lib/trivy-cache"
    clientServerSkipUpdate: true
    
    server:
      resources:
        requests:
          cpu: 200m
          memory: 512Mi
        limits:
          cpu: 1
          memory: 1Gi
      podSecurityContext:
        runAsUser: 65534
        runAsNonRoot: true
        fsGroup: 65534
    
    storageClassEnabled: true
    storageClassName: "longhorn"
    storageSize: "10Gi"