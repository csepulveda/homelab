trivy-operator:
  excludeNamespaces: default
  operator:
    cacheReportTTL: "240h"
    scannerReportTTL: 240h
    scanJobTimeout: 20m
    scanJobsConcurrentLimit: 1
    batchDeleteLimit: 5
    batchDeleteDelay: "30s"
    scanOnlyCurrentRevisions: true
    vulnerabilityScannerScanOnlyCurrentRevisions: true
    configAuditScannerScanOnlyCurrentRevisions: true
    scanJobPodTemplateContainerSecurityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      privileged: false
      readOnlyRootFilesystem: true

  resources:
    requests:
      cpu: 100m
      memory: 512Mi

  serviceMonitor:
    enabled: true
  
  trivy:
    resources:
      requests:
        cpu: 100m
        memory: 2Gi
      limits:
        cpu: 2
        memory: 2Gi

    ignoreUnfixed: true
    # Cache persistente para escaneos de im√°genes
    imageScanCacheDir: "/var/lib/trivy-cache"
    clientServerSkipUpdate: true
    # Habilitar built-in server para mejor cache
    builtInTrivyServer: true
    # Storage persistente para el servidor trivy
    storageClassEnabled: true
    storageClassName: "longhorn"
    storageSize: "10Gi"
    
  # Storage alternativo para reportes persistentes
  alternateReportStorage:
    enabled: true
    storage: "5Gi"
    storageClassName: "longhorn"
    mountPath: "/mnt/trivy-reports"
