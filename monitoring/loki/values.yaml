loki:
  test:
    enabled: false
  lokiCanary:
    enabled: false
  global:
    extraEnv:
    - name: AWS_ACCESS_KEY_ID
      valueFrom:
        secretKeyRef:
          name: loki-bucket
          key: AWS_ACCESS_KEY_ID
    - name: AWS_SECRET_ACCESS_KEY
      valueFrom:
        secretKeyRef:
          name: loki-bucket
          key: AWS_SECRET_ACCESS_KEY
    - name: BUCKET_NAME
      valueFrom:
        configMapKeyRef:
          name: loki-bucket
          key: BUCKET_NAME
  monitoring:
    dashboards:
      enabled: true
    serviceMonitor:
      enabled: true
  loki:
    image:
      tag: 3.5.1
    storage:
      type: s3
      bucketNames:
        chunks: dummy-will-be-overridden
        ruler: dummy-will-be-overridden  
        admin: dummy-will-be-overridden
    config: |
      auth_enabled: false
      common:
        replication_factor: 2
      storage_config:
        aws:
          endpoint: $(BUCKET_HOST):$(BUCKET_PORT)
          region: us-east-1
          s3forcepathstyle: true
          insecure: true
          bucketnames: $(BUCKET_NAME)
        boltdb_shipper:
          active_index_directory: /loki/boltdb-shipper-active
          cache_location: /loki/boltdb-shipper-cache
          cache_ttl: 24h
          shared_store: s3
        tsdb_shipper:
          active_index_directory: /loki/tsdb-shipper-active
          cache_location: /loki/tsdb-shipper-cache
          cache_ttl: 24h
          shared_store: s3
      schema_config:
        configs:
        - from: "2024-10-09"
          index:
            period: 24h
            prefix: loki_index_
          object_store: s3
          schema: v13
          store: tsdb
  minio:
    enabled: false
  read:
    replicas: 2
    extraArgs:
    - -log.level=error
  write:
    replicas: 2
    persistence:
      storageClass: iscsi
    extraArgs:
    - -log.level=error
  backend:
    replicas: 2
    persistence:
      storageClass: iscsi
    extraArgs:
    - -log.level=error
  gateway:
    replicas: 2
    extraArgs:
    - -log.level=error
